/*
 * Pines JavaScript Object
 *
 * Copyright (c) 2010-2011 Hunter Perrin
 *
 * Licensed under the GNU Affero GPL:
 *	  http://www.gnu.org/licenses/agpl.html
 */
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(f,d){var b=this.length>>>0,c=Number(d)||0,c=c<0?Math.ceil(c):Math.floor(c);for(c<0&&(c+=b);c<b;c++)if(c in this&&this[c]===f)return c;return-1};
window.pines||function(f,d){var b=function(a){b.ready(a)};b.full_location="";b.rela_location="";b.safe=function(a){for(var q=[/&/g,/\"/g,/\'/g,/</g,/>/g],l=["&amp;","&quot;","&#039;","&lt;","&gt;"],a=String(a),d=0,b=q.length;d<b;d++)a=a.replace(q[d],l[d]);return a};b.unsafe=function(a){for(var d=[/&amp;/g,/&quot;/g,/&#039;/g,/&lt;/g,/&gt;/g],l=["&",'"',"'","<",">"],a=String(a),b=0,c=d.length;b<c;b++)a=a.replace(d[b],l[b]);return a};b.get=function(a,d,b){if(d){a+=a.indexOf("?")==-1?"?":"&";var c=[],
e;for(e in d)d.hasOwnProperty(e)&&(encodeURIComponent?c.push(encodeURIComponent(e)+"="+encodeURIComponent(d[e])):c.push(escape(e)+"="+escape(d[e])));a+=c.join("&")}!b||b=="_self"?f.location=a:b=="_top"?f.top.location=a:b=="_parent"?f.parent.location=a:b=="_blank"?f.open(a):f.open(a,b)};b.post=function(a,b,c){var e=d.createElement("form");e.action=a;e.method="POST";if(c)e.target=c;for(var f in b)if(b.hasOwnProperty(f))a=d.createElement("input"),a.type="hidden",a.name=f,a.value=b[f],e.appendChild(a);
d.body.appendChild(e);e.submit();d.body.removeChild(e)};b.paused=function(){return c};b.pause=function(){c=true};b.play=function(){c=false;m&&(m=false,j());g&&h()};b.ready=function(a){i.push(a);g&&h()};b.load=function(a){e.push(a);e.length==1&&j()};b.loadjs=function(a,b){if(!(n.indexOf(a)>-1)||b){o=false;var c=d.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("src",a);e.push(c);e.length==1&&j();n[n.length]=a}};b.loadcss=function(a,b){if(!(p.indexOf(a)>-1)||b){var c=
d.createElement("link");c.setAttribute("type","text/css");c.setAttribute("rel","stylesheet");c.setAttribute("href",a);typeof c!="undefined"&&d.getElementsByTagName("head")[0].appendChild(c);p[p.length]=a}};b.notice=function(a,b){alert((b?b:"Notice")+"\n\n"+a)};b.error=function(a,b){alert((b?b:"Error")+"\n\n"+a)};var c=false,m=false,n=[],p=[],e=[],i=[],g=false,o=false,h=function(){if(!(e&&!o||!g||c)){if(i)for(var a=i[0];a;)i=i.slice(1),a.call(),a=i[0];i=[]}},j=function(){if(c)m=true;else{var a=e[0];
typeof a=="undefined"?(o=true,h()):typeof a=="function"?(a.call(),e=e.slice(1),j()):(typeof a.readyState!="undefined"?a.onreadystatechange=function(){if(a.readyState=="loaded"||a.readyState=="complete")a.onreadystatechange=null,e=e.slice(1),j()}:a.onload=function(){e=e.slice(1);j()},typeof a!="undefined"&&d.getElementsByTagName("head")[0].appendChild(a))}},k;d.addEventListener?k=function(){d.removeEventListener("DOMContentLoaded",k,false);g=true;h()}:d.attachEvent&&(k=function(){d.readyState==="complete"&&
(d.detachEvent("onreadystatechange",k),g=true,h())});var r=function(){if(!g){try{d.documentElement.doScroll("left")}catch(a){setTimeout(r,1);return}h()}};if(d.attachEvent){d.attachEvent("onreadystatechange",k);f.attachEvent("onload",function(){g=true;h()});var s=false;try{s=f.frameElement==null}catch(t){}d.documentElement.doScroll&&s&&r()}else d.addEventListener&&(d.addEventListener("DOMContentLoaded",k,false),f.addEventListener("load",function(){g=true;h()},false));f.pines=b}(window,window.document);
